knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
# setting up Oracle connection to local DB
library("ROracle")
library("knitr")
OraInit <- Oracle()
# connect.string <- paste0("(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=srv10-oracle)(PORT=1521))(CONNECT_DATA=(SID=ifqdata)))")
connect.string <- "(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=127.0.0.1)(PORT=6025))(CONNECT_DATA=(SID=bibliodb01)))"
source("credentials_local.R")
source("credentials.R")
OraConn <- dbConnect(OraInit, username=sql_uid, password=sql_pw, dbname = connect.string)
papersByYear <- dbGetQuery(OraConn, strwrap(paste0("
SELECT pubyear, COUNT(DISTINCT fk_items)
FROM wos12b.items it
JOIN wos12b.ITEMS_AUTHORS_INSTITUTIONS iai ON it.pk_items = iai.fk_items
WHERE datasource = 'WOSCI'
AND pubtype = 'J'
AND doctype IN ('@ Article', 'R Review')
AND pubyear BETWEEN 2005 AND 2014
AND type = 'RS'
GROUP BY pubyear
ORDER BY pubyear ASC
"),
width = 100000, simplify = TRUE)
)
paperNullAuthor <- dbGetQuery(OraConn, strwrap(paste0("
SELECT pubyear, COUNT(DISTINCT fk_items)
FROM wos12b.items it
JOIN wos12b.ITEMS_AUTHORS_INSTITUTIONS iai ON it.pk_items = iai.fk_items
WHERE fk_authors IS NULL
AND datasource = 'WOSCI'
AND pubtype = 'J'
AND doctype IN ('@ Article', 'R Review')
AND pubyear BETWEEN 2005 AND 2014
AND type = 'RS'
GROUP BY pubyear
ORDER BY pubyear ASC
"),
width = 100000, simplify = TRUE)
)
paperNullInstitution <- dbGetQuery(OraConn, strwrap(paste0("
SELECT pubyear, COUNT(DISTINCT fk_items)
FROM wos12b.items it
JOIN wos12b.ITEMS_AUTHORS_INSTITUTIONS iai ON it.pk_items = iai.fk_items
WHERE fk_institutions IS NULL
AND datasource = 'WOSCI'
AND pubtype = 'J'
AND doctype IN ('@ Article', 'R Review')
AND pubyear BETWEEN 2005 AND 2014
AND type = 'RS'
GROUP BY pubyear
ORDER BY pubyear ASC
"),
width = 100000, simplify = TRUE)
)
tab_friction <- as.matrix(cbind(paperNullAuthor[,2]/papersByYear[,2], paperNullInstitution[,2]/papersByYear[,2]))*100
paperNullAuthor[,2]/papersByYear[,2]
paperNullInstitution[,2]/papersByYear[,2]
10+10+8+8+5.5
